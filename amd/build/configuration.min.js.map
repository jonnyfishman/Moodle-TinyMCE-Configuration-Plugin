{"version":3,"file":"configuration.min.js","sources":["../src/configuration.js"],"sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * Tiny Media Manager configuration.\n *\n * @module      tiny_configurator/configuration\n * @copyright   2022, Stevani Andolo  <stevani@hotmail.com.au>\n * @license     http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\n\n// import {accessbilityButtonName} from './common';\nimport {\n  removeMenubarItem\n} from 'editor_tiny/utils';\nimport {component} from './common';\n\nexport const configure = async (instanceConfig) => {\n\n\n  // use async IIFE to wait for object elements to be added\n  const disabledToobarButtons = await (async () => {\n    const pluginName = `${component}/plugin:data`;\n\n    while (!instanceConfig[pluginName]) {\n      await new Promise(resolve => setTimeout(resolve, 100));\n    }\n\n    return instanceConfig[pluginName].params;\n  })();\n\n  console.log(disabledToobarButtons);\n\n  const buttonsToRemove = disabledToobarButtons.disabledToobarButtons.split(' ');\n  buttonsToRemove.forEach(button => {\n    if( button.includes(\"[\") ) { // remove top level button\n      instanceConfig.toolbar = instanceConfig.toolbar.filter(function(item) {\n        return item.name !== button.replace('[|]','');\n      });\n    } else {\n      instanceConfig.toolbar.forEach(function (element) {\n        element.items = element.items.filter(function (item) {\n          return item !== button;\n        });\n      });\n    }\n  });\n\n  // These come from editor.js in parent\n\n  // This could be tweaked to change the colours to match the theme etc.\n  if (instanceConfig.menu.format) {\n      instanceConfig.menu.format.items = instanceConfig.menu.format.items\n          // Remove forecolor and backcolor.\n          .replace(/forecolor ?/, '')\n          .replace(/backcolor ?/, '')\n\n          // Remove fontfamily for now.\n          .replace(/fontfamily ?/, '')\n\n          // Remove fontsize for now.\n          .replace(/fontsize ?/, '')\n\n          // Remove styles - it just duplicates the format menu in a way which does not respect configuration\n          .replace(/styles ?/, '')\n\n          // Remove any duplicate separators.\n          .replaceAll(/\\| *\\|/g, '|');\n  }\n\n  // This removes a menu item intirely from the menu bar\n  if (instanceConfig.menu.edit) {\n      instanceConfig.menu.edit.items = '';\n  }\n\n  // This is how to remove menu buttons\n  instanceConfig.menu = removeMenubarItem(instanceConfig.menu, 'format', 'bold');\n\n  // This is how to remove toolbar buttons\n  console.log(instanceConfig);\n  return instanceConfig;\n\n};\n"],"names":["async","disabledToobarButtons","pluginName","component","instanceConfig","Promise","resolve","setTimeout","params","console","log","split","forEach","button","includes","toolbar","filter","item","name","replace","element","items","menu","format","replaceAll","edit"],"mappings":"4NA6ByBA,MAAAA,uBAIjBC,2BAA8B,iBAC5BC,qBAAgBC,wCAEdC,eAAeF,mBACf,IAAIG,SAAQC,SAAWC,WAAWD,QAAS,cAG5CF,eAAeF,YAAYM,QAPA,GAUpCC,QAAQC,IAAIT,8BAEYA,sBAAsBA,sBAAsBU,MAAM,KAC1DC,SAAQC,SAClBA,OAAOC,SAAS,KAClBV,eAAeW,QAAUX,eAAeW,QAAQC,QAAO,SAASC,aACvDA,KAAKC,OAASL,OAAOM,QAAQ,MAAM,OAG5Cf,eAAeW,QAAQH,SAAQ,SAAUQ,SACvCA,QAAQC,MAAQD,QAAQC,MAAML,QAAO,SAAUC,aACtCA,OAASJ,gBASpBT,eAAekB,KAAKC,SACpBnB,eAAekB,KAAKC,OAAOF,MAAQjB,eAAekB,KAAKC,OAAOF,MAEzDF,QAAQ,cAAe,IACvBA,QAAQ,cAAe,IAGvBA,QAAQ,eAAgB,IAGxBA,QAAQ,aAAc,IAGtBA,QAAQ,WAAY,IAGpBK,WAAW,UAAW,MAI3BpB,eAAekB,KAAKG,OACpBrB,eAAekB,KAAKG,KAAKJ,MAAQ,IAIrCjB,eAAekB,MAAO,4BAAkBlB,eAAekB,KAAM,SAAU,QAGvEb,QAAQC,IAAIN,gBACLA"}